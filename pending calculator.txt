select flat_no, name, sum(amount) from (select flat_no, name, COALESCE(month_name,'April 2022') as Month_name, IF(flat_type='rent',500,400) as amount from (select flat_no, flat_type, name, previous_month_id from members m , maintenance me, months mo where me.maintenance_flat_no=m.flat_no and mo.month_id=me.maintenance_month_id and maintenance_status=0) a left join (select month_id, month_name,created_date from months) b on a.previous_month_id=b.month_id order by b.created_date) as c group by flat_no,name;

select flat_no, name, COALESCE(month_name,'April 2022') as Month_name, IF(flat_type='rent',500,400) as amount from (select flat_no, flat_type, name, previous_month_id from members m , maintenance me, months mo where me.maintenance_flat_no=m.flat_no and mo.month_id=me.maintenance_month_id and maintenance_status=0) a left join (select month_id, month_name,created_date from months) b on a.previous_month_id=b.month_id order by flat_no;